import"./home-gallery.js";import"./lenis-CfsBQfFC.js";var e;e=()=>{const e=document.getElementById("albums-carousel");if(!e)return;const t=e.parentElement,n=e.querySelectorAll(".album-carousel-item");if(!n.length)return;let i=0,r=0,a=!1,l=0,s=null;const o=()=>{const e=n[0],t=getComputedStyle(e);return e.offsetWidth+parseFloat(t.marginLeft)+parseFloat(t.marginRight)},c=o()*n.length,d=()=>{e.style.transform=`translate3d(${i}px, 0, 0)`},u=e=>e.type.includes("mouse")?e.clientX:e.touches[0].clientX,m=window.matchMedia&&window.matchMedia("(max-width: 767px)").matches,h=()=>{i-=.6,Math.abs(i)>=c&&(i=0),d(),s=requestAnimationFrame(h)};m||(s=requestAnimationFrame(h));const p=t=>{t.preventDefault(),t.stopPropagation(),a=!0,l=u(t),r=i,s&&(cancelAnimationFrame(s),s=null),e.classList.add("dragging"),document.body.style.userSelect="none"},g=e=>{if(!a)return;e.preventDefault(),e.stopPropagation();const t=u(e);i=r+(t-l),d()},f=()=>{const e=o()*n.length;Math.abs(i)>=e&&(i%=e),i>0&&(i=i%e-e)},v=()=>{a&&(a=!1,e.classList.remove("dragging"),document.body.style.userSelect="",f(),d(),m||setTimeout(()=>{s||(s=requestAnimationFrame(h))},1200))};e.addEventListener("mousedown",p),e.addEventListener("mousemove",g),e.addEventListener("mouseup",v),e.addEventListener("mouseleave",v),e.addEventListener("touchstart",p,{passive:!1}),e.addEventListener("touchmove",g,{passive:!1}),e.addEventListener("touchend",v),e.addEventListener("dragstart",e=>e.preventDefault()),e.addEventListener("selectstart",e=>e.preventDefault()),m||(t.addEventListener("mouseenter",()=>{s&&(cancelAnimationFrame(s),s=null)}),t.addEventListener("mouseleave",()=>{s||a||(s=requestAnimationFrame(h))}));const y=t.parentElement.querySelector(".albums-arrow-left"),w=t.parentElement.querySelector(".albums-arrow-right"),b=()=>1*o();y&&y.addEventListener("click",()=>{i+=b(),f(),d()}),w&&w.addEventListener("click",()=>{i-=b(),f(),d()})},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e),function(){const e=document.getElementById("home-infinite-gallery");if(!e)return;let t=!1;const n=function(){if("string"==typeof window.basePath)return window.basePath;const t=e.querySelector('a[href*="/album/"]');if(t){return t.getAttribute("href").split("/album/")[0]}const n=e.querySelector("img");if(n){const e=n.getAttribute("src");if(e.startsWith("http"))return"";if(e.startsWith("/"))return""}return""}();function i(e){let t=e.url||e.original_path,i=e.fallback_src||t,r=e.sources||{};const a=e=>e?e.startsWith("http")?e:e.startsWith("/")?n+e:(n?n+"/":"")+e:"";e.url&&e.url.includes("/")||(!t||t.startsWith("/")||t.startsWith("http")||(t=a(t)),!i||i.startsWith("/")||i.startsWith("http")||(i=a(i)));const l={};for(const[n,s]of Object.entries(r))Array.isArray(s)&&(l[n]=s.map(e=>{const t=e.split(" ");let n=t[0];return n.startsWith("/")||n.startsWith("http")||(n=a(n)),n+(t[1]?" "+t[1]:"")}));return{id:e.id,album_slug:e.album_slug||e.slug,album_title:e.album_title||e.title,alt:e.alt_text||e.alt||e.album_title,width:parseInt(e.width||1600),height:parseInt(e.height||1067),url:t,fallback_src:i,sources:l}}function r(e,t=!1){const i=e.width/e.height;let r="";const a=e.sources;a.avif&&a.avif.length&&(r+=`<source type="image/avif" srcset="${a.avif.join(", ")}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`),a.webp&&a.webp.length&&(r+=`<source type="image/webp" srcset="${a.webp.join(", ")}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`),a.jpg&&a.jpg.length&&(r+=`<source type="image/jpeg" srcset="${a.jpg.join(", ")}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`);const l=t?'loading="eager" fetchpriority="high"':'loading="lazy"';return`\n      <div class="home-item home-item--revealed group rounded-xl overflow-hidden shadow-sm relative transition-transform hover:scale-105 duration-300" \n           style="aspect-ratio: ${i};">\n        <a href="${n}/album/${e.album_slug}" class="block w-full h-full relative z-10" title="${e.album_title||""}">\n          <picture class="block w-full h-full">\n            ${r}\n            <img src="${e.fallback_src}"\n                 alt="${e.alt||""}"\n                 width="${e.width}" height="${e.height}"\n                 ${l}\n                 decoding="async" class="w-full h-full object-cover block">\n          </picture>\n          <div class="absolute inset-0 bg-black/70 text-white flex items-center justify-center transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">\n            <span class="px-4 text-base md:text-lg lg:text-xl font-medium tracking-tight text-center">${e.album_title||""}</span>\n          </div>\n        </a>\n      </div>\n    `}function a(){if(t)return;t=!0;const e=(window.initialGalleryImages||[]).map(i),n=e.map(e=>e.id).filter(e=>e),a=500-n.length;if(a<=0)return;const l=()=>{const l=n.join(",");fetch(`/api/home/gallery?limit=${a}&exclude=${l}`).then(e=>e.json()).then(t=>{if(t.images){const n=t.images.map(i);!function(e){const t=e.length,n=Math.floor(t/3),i=Math.floor(2*t/3),a=e,l=[...e.slice(n),...e.slice(0,n)],s=[...e.slice(i),...e.slice(0,i)],o=[a,l,s],c=null!==document.querySelector(".home-desktop-vertical");document.querySelector(".home-desktop-horizontal");const d=c?".home-desktop-vertical .home-col":".home-desktop-horizontal .home-row";document.querySelectorAll(d).forEach((e,t)=>{const n=e.querySelector(c?".home-track":".home-track-h");if(!n)return;const i=o[t]||o[0],a=2;let l=[];for(let o=0;o<a;o++)l.push(i.map(e=>c?`<div class="home-cell">${r(e)}</div>`:`<div class="home-cell-h">${r(e)}</div>`).join(""));const s=getComputedStyle(e).getPropertyValue("--home-duration"),d=parseFloat(s),u=(window.initialGalleryImages||[]).length||48;if(!isNaN(d)&&u>0){const t=d*(i.length/u);e.style.setProperty("--home-duration",`${t}s`)}n.innerHTML=l.join("")});document.querySelectorAll(".home-item:not(.home-item--revealed)").forEach(e=>e.classList.add("home-item--revealed"))}([...e,...n])}}).catch(e=>{}).finally(()=>t=!1)};"requestIdleCallback"in window?requestIdleCallback(l,{timeout:3e3}):setTimeout(l,2e3)}"complete"===document.readyState?a():window.addEventListener("load",a)}(),function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}(()=>{const e=document.getElementById("home-infinite-gallery");if(!e)return;const t=document.querySelector(".home-mobile-wrap"),n=document.querySelector(".home-desktop-wrap"),i=()=>{t&&n&&(window.innerWidth>=768?(t.style.display="none",n.style.display="flex"):(t.style.display="block",n.style.display="none"))};i();let r=null;window.addEventListener("resize",()=>{r||(r=requestAnimationFrame(()=>{i(),r=null}))}),e.style.opacity="1",Array.from(e.querySelectorAll(".home-item")).forEach(e=>e.classList.add("home-item--revealed"))});
