import"./home-gallery.js";import"./lenis-CfsBQfFC.js";var e;e=()=>{const e=document.getElementById("albums-carousel");if(!e)return;const t=e.parentElement,n=e.querySelectorAll(".album-carousel-item");if(!n.length)return;let s=0,a=0,r=!1,i=0,o=null;const l=()=>{const e=n[0],t=getComputedStyle(e);return e.offsetWidth+parseFloat(t.marginLeft)+parseFloat(t.marginRight)},d=l()*n.length,c=()=>{e.style.transform=`translate3d(${s}px, 0, 0)`},m=e=>e.type.includes("mouse")?e.clientX:e.touches[0].clientX,h=window.matchMedia&&window.matchMedia("(max-width: 767px)").matches,u=()=>{s-=.6,Math.abs(s)>=d&&(s=0),c(),o=requestAnimationFrame(u)};h||(o=requestAnimationFrame(u));const g=t=>{t.preventDefault(),t.stopPropagation(),r=!0,i=m(t),a=s,o&&(cancelAnimationFrame(o),o=null),e.classList.add("dragging"),document.body.style.userSelect="none"},p=e=>{if(!r)return;e.preventDefault(),e.stopPropagation();const t=m(e);s=a+(t-i),c()},w=()=>{const e=l()*n.length;Math.abs(s)>=e&&(s%=e),s>0&&(s=s%e-e)},v=()=>{r&&(r=!1,e.classList.remove("dragging"),document.body.style.userSelect="",w(),c(),h||setTimeout(()=>{o||(o=requestAnimationFrame(u))},1200))};e.addEventListener("mousedown",g),e.addEventListener("mousemove",p),e.addEventListener("mouseup",v),e.addEventListener("mouseleave",v),e.addEventListener("touchstart",g,{passive:!1}),e.addEventListener("touchmove",p,{passive:!1}),e.addEventListener("touchend",v),e.addEventListener("dragstart",e=>e.preventDefault()),e.addEventListener("selectstart",e=>e.preventDefault()),h||(t.addEventListener("mouseenter",()=>{o&&(cancelAnimationFrame(o),o=null)}),t.addEventListener("mouseleave",()=>{o||r||(o=requestAnimationFrame(u))}));const y=t.parentElement.querySelector(".albums-arrow-left"),f=t.parentElement.querySelector(".albums-arrow-right"),b=()=>1*l();y&&y.addEventListener("click",()=>{s+=b(),w(),c()}),f&&f.addEventListener("click",()=>{s-=b(),w(),c()})},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e);class t{constructor(e={}){this.apiUrl=e.apiUrl||"/api/home/gallery",this.container=e.container,this.renderImage=e.renderImage,this.batchSize=e.batchSize||20,this.shownAlbumIds=e.shownAlbumIds||[],this.hasMore=!0,this.loading=!1,this.shownImageIds=new Set((e.shownImageIds||[]).map(e=>parseInt(e,10)))}async loadMore(){if(!this.loading&&this.hasMore){this.loading=!0;try{const e=new URLSearchParams({exclude:Array.from(this.shownImageIds).join(","),excludeAlbums:this.shownAlbumIds.join(","),limit:String(this.batchSize)}),t=await fetch(`${this.apiUrl}?${e}`);if(!t.ok)return void(this.hasMore=!1);const n=await t.json();Array.isArray(n.images)&&n.images.forEach(e=>{const t=parseInt(e.id,10);this.shownImageIds.has(t)||(this.renderImage&&this.renderImage(e),this.shownImageIds.add(t))}),Array.isArray(n.newAlbumIds)&&this.shownAlbumIds.push(...n.newAlbumIds),this.hasMore=Boolean(n.hasMore)}catch(e){this.hasMore=!1}finally{this.loading=!1}}}observe(e){if(!e)return;new IntersectionObserver(e=>{e[0].isIntersecting&&this.hasMore&&!this.loading&&this.loadMore()},{rootMargin:"200px"}).observe(e)}startBackgroundLoading(){requestAnimationFrame(()=>{this.loadMore()})}hasMoreImages(){return this.hasMore}isLoading(){return this.loading}getLoadedCount(){return this.shownImageIds.size}}!function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}(()=>{const e=document.getElementById("home-infinite-gallery");if(!e)return;const n=document.querySelector(".home-mobile-wrap"),s=document.querySelector(".home-desktop-wrap"),a=()=>{n&&s&&(window.innerWidth>=768?(n.style.display="none",s.style.display="flex"):(n.style.display="block",s.style.display="none"))};a();let r=null;window.addEventListener("resize",()=>{r||(r=requestAnimationFrame(()=>{a(),r=null}))}),e.style.opacity="1",Array.from(e.querySelectorAll(".home-item")).forEach(e=>e.classList.add("home-item--revealed"));const i=window.homeLoaderConfig;if(i&&i.hasMore){const n=null!==e.closest('[data-scroll-direction="horizontal"]'),s=e.querySelector(".home-mobile"),a=n?Array.from(e.querySelectorAll(".home-track-h")):Array.from(e.querySelectorAll(".home-track"));let r=0;const o=new t({apiUrl:`${i.basePath}/api/home/gallery`,container:e,shownImageIds:i.shownImageIds,shownAlbumIds:i.shownAlbumIds,batchSize:20,renderImage:e=>{const t=function(e,t){var n,s,a;const r=e.width||1600,i=e.height||1067,o=e=>e&&e.length?e.map(e=>{const n=e.split(" ");return`${n[0].startsWith("/")?t+n[0]:n[0]} ${n[1]||"1x"}`}).join(", "):"",l=o(null==(n=e.sources)?void 0:n.avif),d=o(null==(s=e.sources)?void 0:s.webp),c=o(null==(a=e.sources)?void 0:a.jpg),m=e.fallback_src||e.url,h=m.startsWith("/")?t+m:m,u=`${t}/album/${e.album_slug}`,g=e.alt||e.album_title||"",p=e.album_title||"",w=document.createElement("div");return w.className="home-cell",w.innerHTML=`\n      <div class="home-item home-item--revealed group rounded-xl overflow-hidden shadow-sm relative transition-transform hover:scale-105 duration-300" style="aspect-ratio: ${r} / ${i};" data-image-id="${e.id}">\n        <a href="${u}" class="block w-full h-full relative z-10" title="${p.replace(/"/g,"&quot;")}">\n          <picture class="block w-full h-full">\n            ${l?`<source type="image/avif" srcset="${l}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            ${d?`<source type="image/webp" srcset="${d}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            ${c?`<source type="image/jpeg" srcset="${c}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            <img src="${h}" alt="${g.replace(/"/g,"&quot;")}" width="${r}" height="${i}" loading="lazy" decoding="async" class="w-full h-full object-cover block">\n          </picture>\n          <div class="absolute inset-0 bg-black/70 text-white flex items-center justify-center transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">\n            <span class="px-4 text-base md:text-lg lg:text-xl font-medium tracking-tight text-center">${p.replace(/</g,"&lt;")}</span>\n          </div>\n        </a>\n      </div>\n    `,w}(e,i.basePath);if(s){const e=t.cloneNode(!0);s.appendChild(e)}a.length>0&&(a[r%a.length].appendChild(t),r++)}});o.startBackgroundLoading();const l=document.getElementById("home-load-trigger");l&&o.observe(l)}});
