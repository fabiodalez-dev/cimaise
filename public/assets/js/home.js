import"./home-gallery.js";import"./lenis-CfsBQfFC.js";var e;e=()=>{const e=document.getElementById("albums-carousel");if(!e)return;const t=e.parentElement,n=e.querySelectorAll(".album-carousel-item");if(!n.length)return;let s=0,r=0,a=!1,i=0,o=null;const l=()=>{const e=n[0],t=getComputedStyle(e);return e.offsetWidth+parseFloat(t.marginLeft)+parseFloat(t.marginRight)},d=l()*n.length,c=()=>{e.style.transform=`translate3d(${s}px, 0, 0)`},m=e=>e.type.includes("mouse")?e.clientX:e.touches[0].clientX,h=window.matchMedia&&window.matchMedia("(max-width: 767px)").matches,u=()=>{s-=.6,Math.abs(s)>=d&&(s=0),c(),o=requestAnimationFrame(u)};h||(o=requestAnimationFrame(u));const g=t=>{t.preventDefault(),t.stopPropagation(),a=!0,i=m(t),r=s,o&&(cancelAnimationFrame(o),o=null),e.classList.add("dragging"),document.body.style.userSelect="none"},p=e=>{if(!a)return;e.preventDefault(),e.stopPropagation();const t=m(e);s=r+(t-i),c()},v=()=>{const e=l()*n.length;Math.abs(s)>=e&&(s%=e),s>0&&(s=s%e-e)},w=()=>{a&&(a=!1,e.classList.remove("dragging"),document.body.style.userSelect="",v(),c(),h||setTimeout(()=>{o||(o=requestAnimationFrame(u))},1200))};e.addEventListener("mousedown",g),e.addEventListener("mousemove",p),e.addEventListener("mouseup",w),e.addEventListener("mouseleave",w),e.addEventListener("touchstart",g,{passive:!1}),e.addEventListener("touchmove",p,{passive:!1}),e.addEventListener("touchend",w),e.addEventListener("dragstart",e=>e.preventDefault()),e.addEventListener("selectstart",e=>e.preventDefault()),h||(t.addEventListener("mouseenter",()=>{o&&(cancelAnimationFrame(o),o=null)}),t.addEventListener("mouseleave",()=>{o||a||(o=requestAnimationFrame(u))}));const f=t.parentElement.querySelector(".albums-arrow-left"),y=t.parentElement.querySelector(".albums-arrow-right"),b=()=>1*l();f&&f.addEventListener("click",()=>{s+=b(),v(),c()}),y&&y.addEventListener("click",()=>{s-=b(),v(),c()})},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e);class t{constructor(e={}){this.apiUrl=e.apiUrl||"/api/home/gallery",this.container=e.container,this.renderImage=e.renderImage,this.batchSize=e.batchSize||20,this.hasMore=!0,this.loading=!1,this.observer=null,this.shownImageIds=new Set((e.shownImageIds||[]).map(e=>parseInt(e,10)).filter(e=>!isNaN(e)&&e>0)),this.shownAlbumIds=new Set((e.shownAlbumIds||[]).map(e=>parseInt(e,10)).filter(e=>!isNaN(e)&&e>0))}async loadMore(){if(!this.loading&&this.hasMore){this.loading=!0;try{const e=new URLSearchParams({exclude:Array.from(this.shownImageIds).join(","),excludeAlbums:Array.from(this.shownAlbumIds).join(","),limit:String(this.batchSize)}),t=await fetch(`${this.apiUrl}?${e}`);if(!t.ok)return void(this.hasMore=!1);const n=await t.json();Array.isArray(n.images)&&n.images.forEach(e=>{const t=parseInt(e.id,10);isNaN(t)||t<=0||this.shownImageIds.has(t)||(this.renderImage&&this.renderImage(e),this.shownImageIds.add(t))}),Array.isArray(n.newAlbumIds)&&n.newAlbumIds.forEach(e=>{const t=parseInt(e,10);!isNaN(t)&&t>0&&this.shownAlbumIds.add(t)}),this.hasMore=Boolean(n.hasMore)}catch(e){this.hasMore=!1}finally{this.loading=!1}}}observe(e){e&&(this.observer&&this.observer.disconnect(),this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.hasMore&&!this.loading&&this.loadMore()},{rootMargin:"200px"}),this.observer.observe(e))}disconnect(){this.observer&&(this.observer.disconnect(),this.observer=null)}startBackgroundLoading(){requestAnimationFrame(()=>{this.loadMore()})}hasMoreImages(){return this.hasMore}isLoading(){return this.loading}getLoadedCount(){return this.shownImageIds.size}}!function(){function e(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function n(t,n,s){var r,a,i;const o=t.width||1600,l=t.height||1067,d=e=>e&&e.length?e.map(e=>{const t=e.split(" ");return`${t[0].startsWith("/")?n+t[0]:t[0]} ${t[1]||"1x"}`}).join(", "):"",c=d(null==(r=t.sources)?void 0:r.avif),m=d(null==(a=t.sources)?void 0:a.webp),h=d(null==(i=t.sources)?void 0:i.jpg),u=t.fallback_src||t.url,g=u.startsWith("/")?n+u:u,p=`${n}/album/${encodeURIComponent(t.album_slug||"")}`,v=t.alt||t.album_title||"",w=t.album_title||"",f=document.createElement("div");return f.className=s?"home-cell-h":"home-cell",f.innerHTML=`\n      <div class="home-item home-item--revealed group rounded-xl overflow-hidden shadow-sm relative transition-transform hover:scale-105 duration-300" style="aspect-ratio: ${parseInt(o,10)} / ${parseInt(l,10)};" data-image-id="${parseInt(t.id,10)||0}">\n        <a href="${e(p)}" class="block w-full h-full relative z-10" title="${e(w)}">\n          <picture class="block w-full h-full">\n            ${c?`<source type="image/avif" srcset="${e(c)}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            ${m?`<source type="image/webp" srcset="${e(m)}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            ${h?`<source type="image/jpeg" srcset="${e(h)}" sizes="(min-width:1024px) 50vw, (min-width:640px) 70vw, 100vw">`:""}\n            <img src="${e(g)}" alt="${e(v)}" width="${parseInt(o,10)}" height="${parseInt(l,10)}" loading="lazy" decoding="async" class="w-full h-full object-cover block">\n          </picture>\n          <div class="absolute inset-0 bg-black/70 text-white flex items-center justify-center transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">\n            <span class="px-4 text-base md:text-lg lg:text-xl font-medium tracking-tight text-center">${function(e){if(null==e)return"";const t=document.createElement("div");return t.textContent=String(e),t.innerHTML}(w)}</span>\n          </div>\n        </a>\n      </div>\n    `,f}!function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}(()=>{const e=document.getElementById("home-infinite-gallery");if(!e)return;const s=document.querySelector(".home-mobile-wrap"),r=document.querySelector(".home-desktop-wrap"),a=()=>{s&&r&&(window.innerWidth>=768?(s.style.display="none",r.style.display="flex"):(s.style.display="block",r.style.display="none"))};a();let i=null;window.addEventListener("resize",()=>{i||(i=requestAnimationFrame(()=>{a(),i=null}))}),e.style.opacity="1";Array.from(e.querySelectorAll(".home-item")).forEach(e=>e.classList.add("home-item--revealed"));const o=window.homeLoaderConfig;if(o&&o.hasMore){const s=null!==e.closest('[data-scroll-direction="horizontal"]'),r=e.querySelector(".home-mobile"),a=s?Array.from(e.querySelectorAll(".home-track-h")):Array.from(e.querySelectorAll(".home-track"));let i=0;const l=new t({apiUrl:`${o.basePath}/api/home/gallery`,container:e,shownImageIds:o.shownImageIds,shownAlbumIds:o.shownAlbumIds,batchSize:20,renderImage:e=>{const t=n(e,o.basePath,s);if(r){const e=t.cloneNode(!0);e.className="home-cell",r.appendChild(e)}if(a.length>0){a[i%a.length].appendChild(t),i++}}});l.startBackgroundLoading();const d=document.getElementById("home-load-trigger");d&&l.observe(d)}})}();
