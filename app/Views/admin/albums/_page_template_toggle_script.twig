<script nonce="{{ csp_nonce() }}">
(function() {
  const pageSelect = document.querySelector('[data-album-page-template-select]');
  const galleryContainer = document.querySelector('[data-gallery-template-container]');
  const galleryLabel = document.querySelector('[data-gallery-template-label]');
  const gallerySelect = document.querySelector('[data-gallery-template-select]');
  const galleryNote = document.querySelector('[data-gallery-template-note]');
  const allowSwitchInput = document.querySelector('#allow_template_switch');
  if (!pageSelect || !galleryContainer || !gallerySelect || !galleryLabel) return;

  function updateVisibility() {
    const option = pageSelect.options[pageSelect.selectedIndex];
    const usesGallery = option ? option.dataset.usesGallery !== '0' : true;
    galleryLabel.classList.toggle('hidden', !usesGallery);
    gallerySelect.classList.toggle('hidden', !usesGallery);
    if (galleryNote) galleryNote.classList.toggle('hidden', usesGallery);
    if (allowSwitchInput) {
      if (!usesGallery) {
        allowSwitchInput.checked = false;
        allowSwitchInput.disabled = true;
      } else {
        allowSwitchInput.disabled = false;
      }
    }
  }

  pageSelect.addEventListener('change', updateVisibility);
  updateVisibility();
})();
</script>
